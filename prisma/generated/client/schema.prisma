// prisma/schema.prisma
datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

generator client {
  provider = "prisma-client-js"
  output   = "./generated/client"
}

model User {
  id               Int       @id @default(autoincrement())
  createdAt        DateTime  @default(now())
  phoneNumber      String?
  username         String?
  image            String?
  email            String    @unique
  ads              Ad[]
  chats            Chat[]
  messagesSent     Message[] @relation("sentMessages")
  messagesReceived Message[] @relation("receivedMessages")
}

model Image {
  id   Int    @id @default(autoincrement())
  url  String
  ad   Ad     @relation(fields: [adId], references: [id])
  adId Int
}

model Ad {
  id                     Int      @id @default(autoincrement())
  user                   User?    @relation(fields: [userId], references: [id])
  userId                 Int?
  createdAt              DateTime @default(now())
  Adimages               Image[]
  description            String?
  brand                  String
  EnginCapacity          String
  category               String
  carType                String
  model                  String
  year                   String
  carStatus              String
  transmission           String
  fuelType               String
  meterRange             String
  paintType              String
  payment                String
  price                  String
  name                   String
  RegionalSpecifications String
  location               String
  extraFeatures          String?
}

model Chat {
  id       Int       @id @default(autoincrement())
  users    User[]
  messages Message[]
}

model Message {
  id            Int      @id @default(autoincrement())
  content       String
  sender        User     @relation("sentMessages", fields: [senderEmail], references: [email])
  senderEmail   String
  receiver      User     @relation("receivedMessages", fields: [receiverEmail], references: [email])
  receiverEmail String
  createdAt     DateTime @default(now())
  chatId        Int
  chat          Chat     @relation(fields: [chatId], references: [id])
}
